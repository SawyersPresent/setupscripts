#!/usr/bin/env python3
# filepath: nxc_users

import sys

def show_help():
    print("nxc_users - Extract usernames from NetExec output")
    print()
    print("Usage:")
    print("  nxc smb target --users | nxc_users")
    print("  nxc_users --help")
    print()
    print("Example:")
    print("  nxc smb dc01.test.local -u admin -p pass --users | nxc_users > users.txt")
    print()
    print("Description:")
    print("  Filters NetExec --users output to extract clean usernames")

def go():
    raw = sys.stdin.read().strip()
    for line in raw.splitlines():
        if any(x in line for x in ['[*]', '[+]', '-Username-']):
            continue
        try:
            print(line.split()[4])
        except:
            pass

if __name__ == "__main__":
    if len(sys.argv) > 1 and sys.argv[1] in ['-h', '--help']:
        show_help()
        sys.exit(0)
    go()